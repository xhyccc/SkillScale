FROM docker.1ms.run/library/python:3.12-slim

WORKDIR /app

# Install agent dependencies
COPY agent/requirements.txt /tmp/agent-requirements.txt
RUN pip install --no-cache-dir -r /tmp/agent-requirements.txt

# Install the skillscale SDK
COPY pyproject.toml /app/pyproject.toml
COPY skillscale/ /app/skillscale/
RUN pip install --no-cache-dir -e .

# Copy agent code
COPY agent/ /app/agent/

ENV SKILLSCALE_PROXY_XSUB=tcp://proxy:5444
ENV SKILLSCALE_PROXY_XPUB=tcp://proxy:5555
ENV SKILLSCALE_TIMEOUT=300

ENTRYPOINT ["python3", "agent/main.py"]
